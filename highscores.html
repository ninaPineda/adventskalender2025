<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Adventskalender</title>
    <link rel="stylesheet" href="style.css" />
    <meta name="theme-color" content="#000000" />
  </head>

  <body>
    <!-- Desktop-Blocker -->
    <div class="desktop-blocker" aria-hidden="true">
      <p>Bitte am Handy Ã¶ffnen ðŸ“±</p>
    </div>

    <header class="site-header">
      <h1 class="adventskalender">Info</h1>
      <div class="coins"></div>
    </header>

    <main class="info-content">
      <div class="info-backdrop"></div>
      <a href="index.html" class="back-button"></a>
      <h1>Wer hat schon was geschafft?</h1>
      <div id="scoreList"></div>
    </main>
    <script src="app.js"></script>
<script>
  function onScores(data) {
    // neueste zuerst
    data.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

    // Leaderboard zÃ¤hlen
    const leaderboard = {};
    data.forEach(row => {
      const name = row.name || "Unbekannt";
      leaderboard[name] = (leaderboard[name] || 0) + 1;
    });

    const leaderboardArr = Object.entries(leaderboard)
      .sort((a, b) => b[1] - a[1]);

    const wrap = document.getElementById("scoreList");
    wrap.innerHTML = `
      <h2>Bestenliste</h2>
      <div class="leaderboard">
        ${leaderboardArr.map(([name, count], i) => `
          <div class="score-row">
            <span>#${i + 1}</span>
            <span>${name}</span>
            <span>${count} gelÃ¶st</span>
          </div>
        `).join("")}
      </div>

      <h2>Letzte LÃ¶sungen</h2>
      <div class="recent">
        ${data.map(entry => `
          <div class="score-row">
            <span>${new Date(entry.timestamp).toLocaleString()}</span>
            <span>${entry.name}</span>
            <span>${entry.solved}</span>
          </div>
        `).join("")}
      </div>
    `;
  }
</script>

<script src="https://script.google.com/macros/s/AKfycbxE2viBiew4764LuIA6OevSyb2h5YNvIHkQEa3ym1BiEn_UftktZenu9XF8P5CVMz-btw/exec?callback=onScores"></script>
  </body>
</html>